_visible: 'true'
_last_published_date: '1677069434665'
_exact: 'false'
_authenticated: 'false'

---
<div id="contact" class="modal">
    <!-- Modal content -->
    <div class="modal-content">
        <div class="modal-header">
            <h1>Demande de contact</h1>
            <span class="close-contact" onclick = closeModalContact()>&times;</span>
        </div>
        <h2></h2>
        <form id="form-contact" method="post" action="/api/tenants/{{tenant._id}}/_contact" >
          <div class="form-group">
            <label for="sender-name">NOM Prénom</label>
            {{#if connected}}
              <input required="true" type="text" class="form-control" id="sender-name" name="name" aria-describedby="Renseigner vos NOM Prénom" placeholder="Renseigner votre nom" value="{{user.name}}">
            {{/if}}
            {{#unless connected}}
              <input required="true" type="text" class="form-control" id="sender-name" name="name" aria-describedby="Renseigner vos NOM Prénom" placeholder="Renseigner votre nom" value="">
            {{/unless}}
          </div>
          <div class="form-group">
            <label for="sender-email">Courriel</label>
            <input required="true" type="email" class="form-control" id="sender-email" name="email" aria-describedby="Renseigner votre courriel" placeholder="Renseigner votre courriel" value="{{user.email}}">
          </div>
          <div class="form-group">
            <label for="subject">Objet</label>
            <input required="true" type="text" class="form-control" id="subject" name="subject" aria-describedby="subject" placeholder="Objet" value="">
          </div>
          <div class="form-group">
            <label for="message">Message</label>
            <textarea required="true" id="body" name="body" cols="30" rows="7" class="form-control" aria-describedby="Votre message" placeholder="Votre message"></textarea>
          </div>
          
          <!--<input type="hidden" name="teamId" value="{{team.id}}" >-->
          
          <div class="modal-footer">
            <button type="submit">Envoyer</button>
          </div>
        </form>
    </div>
</div>

<script>
  var form = document.getElementById('form-contact');
  form.onsubmit = function(event){
      var xhr = new XMLHttpRequest();
      var formData = new FormData(form);
      //open the request
      xhr.open('POST','/api/tenants/{{tenant._id}}/_contact')
      xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");

      //send the form data
      xhr.send(JSON.stringify(Object.fromEntries(formData)));

      xhr.onreadystatechange = function() {
          if (xhr.readyState == XMLHttpRequest.DONE) {
              form.reset(); //reset form after AJAX success or do something else
              var modalContact = document.getElementById("contact");
              modalContact.style.display = "none";
              var modalContactSuccess = document.getElementById("contact-success");
              modalContactSuccess.style.display = "block";
          }
      }
      //Fail the onsubmit to avoid page refresh.
      return false; 
  }
</script>
