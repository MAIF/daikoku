"use strict";(self.webpackChunkdaikoku_documentation=self.webpackChunkdaikoku_documentation||[]).push([[2849],{42956:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>u});const t=JSON.parse('{"id":"guides/develop-daikoku","title":"Daikoku Development Guide","description":"How to set up a local development environment for Daikoku (frontend + backend) quickly.","source":"@site/docs/03-guides/16-dev.mdx","sourceDirName":"03-guides","slug":"/guides/develop-daikoku","permalink":"/daikoku/docs/guides/develop-daikoku","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"id":"develop-daikoku","title":"Daikoku Development Guide","sidebar_position":10,"description":"How to set up a local development environment for Daikoku (frontend + backend) quickly."},"sidebar":"tutorialSidebar","previous":{"title":"Jobs","permalink":"/daikoku/docs/guides/jobs"},"next":{"title":"Integrations API","permalink":"/daikoku/docs/guides/integrations"}}');var s=r(74848),l=r(28453),o=r(65537),i=r(79329);const a={id:"develop-daikoku",title:"Daikoku Development Guide",sidebar_position:10,description:"How to set up a local development environment for Daikoku (frontend + backend) quickly."},d="Daikoku Development Guide",c={},u=[{value:"1) Prerequisites",id:"1-prerequisites",level:2},{value:"2) Start PostgreSQL in Docker",id:"2-start-postgresql-in-docker",level:2},{value:"3) Start the Frontend (Vite Dev Server)",id:"3-start-the-frontend-vite-dev-server",level:2},{value:"4) Prepare static files for backend (development mode)",id:"4-prepare-static-files-for-backend-development-mode",level:2},{value:"5) Start the Backend in Hot Reload Mode",id:"5-start-the-backend-in-hot-reload-mode",level:2},{value:"6) Open the Application",id:"6-open-the-application",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Port 5173 already in use",id:"port-5173-already-in-use",level:3},{value:"PostgreSQL connection issues",id:"postgresql-connection-issues",level:3},{value:"sbt not reloading properly",id:"sbt-not-reloading-properly",level:3},{value:"Node dependency problems",id:"node-dependency-problems",level:3},{value:"Recommended Development Workflow",id:"recommended-development-workflow",level:2},{value:"Contribution Tips",id:"contribution-tips",level:2}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"daikoku-development-guide",children:"Daikoku Development Guide"})}),"\n",(0,s.jsxs)(n.p,{children:["This guide aims at helping people willing to contribute to the Daikoku codebase.\nThis guide will help you set up a ",(0,s.jsx)(n.strong,{children:"full Daikoku development environment"})," \u2014 including PostgreSQL (via Docker), the ",(0,s.jsx)(n.strong,{children:"frontend (Vite)"}),", and the ",(0,s.jsx)(n.strong,{children:"backend (Scala + Play)"})," \u2014 with live reload enabled."]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["Replace or export ",(0,s.jsx)(n.code,{children:"$DAIKOKU_PROJECT_ROOT"})," with your local daikoku project path, for example ",(0,s.jsx)(n.code,{children:"~/projects/daikoku"})," in case you did something\nlike ",(0,s.jsx)(n.code,{children:"git clone git@github.com:MAIF/daikoku.git ~/projects/daikoku"})]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"1-prerequisites",children:"1) Prerequisites"}),"\n",(0,s.jsx)(n.p,{children:"Make sure you have the following installed:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.strong,{children:"JDK 21+"})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Scala"})," & ",(0,s.jsx)(n.strong,{children:"sbt"})," (latest recommended version)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Node.js 22.x"})," & ",(0,s.jsx)(n.strong,{children:"npm"})," (Vite requires a modern Node version)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Docker"})," (to run PostgreSQL, and later Elasticsearch, Otoroshi and Minio)"]}),"\n",(0,s.jsxs)(n.li,{children:["a clone of the ",(0,s.jsx)(n.strong,{children:"Daikoku code repository"})," (",(0,s.jsx)(n.code,{children:"git clone git@github.com:MAIF/daikoku.git"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["If you use ",(0,s.jsx)(n.strong,{children:"nvm"}),", you can install Node 22 easily:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nvm install 22\nnvm use 22\nnode -v   # should show v22.x\nnpm -v\n"})})]}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsxs)(n.p,{children:["If you use ",(0,s.jsx)(n.a,{href:"https://get-coursier.io/",children:(0,s.jsx)(n.strong,{children:"coursier"})}),", you can install Scala and sbt easily:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cs install scala sbt\nscala -version\nsbt -version\n"})})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"2-start-postgresql-in-docker",children:"2) Start PostgreSQL in Docker"}),"\n",(0,s.jsx)(n.p,{children:"Run a local PostgreSQL instance dedicated to Daikoku:"}),"\n",(0,s.jsx)(o.A,{children:(0,s.jsx)(i.A,{value:"docker-run",label:"docker run (simple)",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker run --name daikoku-pg \\\n  -e POSTGRES_USER=postgres \\\n  -e POSTGRES_PASSWORD=postgres \\\n  -e POSTGRES_DB=default \\\n  -p 5432:5432 \\\n  -d postgres:17\n"})})})}),"\n",(0,s.jsx)(n.admonition,{title:"Default connection info",type:"note",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Host"}),": ",(0,s.jsx)(n.code,{children:"localhost"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Port"}),": ",(0,s.jsx)(n.code,{children:"5432"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Database"}),": ",(0,s.jsx)(n.code,{children:"default"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"User / Password"}),": ",(0,s.jsx)(n.code,{children:"postgres"})," / ",(0,s.jsx)(n.code,{children:"postgres"})]}),"\n"]})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"3-start-the-frontend-vite-dev-server",children:"3) Start the Frontend (Vite Dev Server)"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.strong,{children:"Terminal A"}),", go to the ",(0,s.jsx)(n.code,{children:"javascript"})," folder and start the Vite development server:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd $DAIKOKU_PROJECT_ROOT/daikoku/javascript\nnpm install\nnpm start\n"})}),"\n",(0,s.jsxs)(n.p,{children:["By default, the UI will run on ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"http://localhost:5173",children:"http://localhost:5173"})}),"."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"4-prepare-static-files-for-backend-development-mode",children:"4) Prepare static files for backend (development mode)"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.strong,{children:"Terminal B"}),", copy the frontend ",(0,s.jsx)(n.code,{children:"index.html"})," into the backend\u2019s ",(0,s.jsx)(n.code,{children:"public"})," folder so that the backend can serve the dev UI correctly:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cp $DAIKOKU_PROJECT_ROOT/daikoku/javascript/index.html \\\n   $DAIKOKU_PROJECT_ROOT/daikoku/public/index.html\n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"This step ensures the backend and frontend stay in sync while developing."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"5-start-the-backend-in-hot-reload-mode",children:"5) Start the Backend in Hot Reload Mode"}),"\n",(0,s.jsxs)(n.p,{children:["In ",(0,s.jsx)(n.strong,{children:"Terminal B"}),", start the backend with ",(0,s.jsx)(n.code,{children:"sbt"})," and enable continuous compilation:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd $DAIKOKU_PROJECT_ROOT/daikoku\nsbt\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Inside the ",(0,s.jsx)(n.code,{children:"sbt"})," console:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sbt",children:"~run\n"})}),"\n",(0,s.jsx)(n.p,{children:"This will automatically reload the backend each time you change Scala or configuration files."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"6-open-the-application",children:"6) Open the Application"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Frontend (Vite)"}),": ",(0,s.jsx)(n.a,{href:"http://localhost:5173",children:"http://localhost:5173"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backend (Play)"}),": runs on its default port (typically 9000, depending on config)"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\ud83d\udc49 Open your browser at ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"http://localhost:5173",children:"http://localhost:5173"})})," to start working."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsx)(n.h3,{id:"port-5173-already-in-use",children:"Port 5173 already in use"}),"\n",(0,s.jsxs)(n.p,{children:["Change the Vite port (",(0,s.jsx)(n.code,{children:"--port 5174"}),") or stop the conflicting process."]}),"\n",(0,s.jsx)(n.h3,{id:"postgresql-connection-issues",children:"PostgreSQL connection issues"}),"\n",(0,s.jsx)(n.p,{children:"Make sure the container is running:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker ps | grep daikoku-pg\n"})}),"\n",(0,s.jsx)(n.p,{children:"Test database access:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker exec -it daikoku-pg psql -U daikoku -d daikoku -c '\\dt'\n"})}),"\n",(0,s.jsx)(n.h3,{id:"sbt-not-reloading-properly",children:"sbt not reloading properly"}),"\n",(0,s.jsxs)(n.p,{children:["Ensure you\u2019re running ",(0,s.jsx)(n.strong,{children:"JDK 21+"})," and clear the build cache if needed:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sbt clean\n"})}),"\n",(0,s.jsx)(n.h3,{id:"node-dependency-problems",children:"Node dependency problems"}),"\n",(0,s.jsx)(n.p,{children:"Clean and reinstall:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"rm -rf node_modules package-lock.json\nnpm install\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"recommended-development-workflow",children:"Recommended Development Workflow"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backend"})," running in ",(0,s.jsx)(n.strong,{children:"Terminal B"})," with ",(0,s.jsx)(n.code,{children:"sbt ~run"})," for live reload."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Frontend"})," running in ",(0,s.jsx)(n.strong,{children:"Terminal A"})," with ",(0,s.jsx)(n.code,{children:"npm start"})," for HMR (hot module reload)."]}),"\n",(0,s.jsxs)(n.li,{children:["Open ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.a,{href:"http://localhost:5173",children:"http://localhost:5173"})})," and iterate!"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"contribution-tips",children:"Contribution Tips"}),"\n",(0,s.jsx)(n.p,{children:"Before opening a pull request:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run all available tests and linters."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Clearly describe:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"What problem or feature your change addresses."}),"\n",(0,s.jsx)(n.li,{children:"The potential impact or breaking changes."}),"\n",(0,s.jsx)(n.li,{children:"How to manually test your change."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"Happy hacking \ud83d\udca5\nWelcome to the Daikoku developer community!"})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},79329:(e,n,r)=>{r.d(n,{A:()=>o});r(96540);var t=r(34164);const s={tabItem:"tabItem_Ymn6"};var l=r(74848);function o(e){let{children:n,hidden:r,className:o}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,t.A)(s.tabItem,o),hidden:r,children:n})}},65537:(e,n,r)=>{r.d(n,{A:()=>y});var t=r(96540),s=r(34164),l=r(65627),o=r(56347),i=r(50372),a=r(30604),d=r(11861),c=r(78749);function u(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:r}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:r,attributes:t,default:s}}=e;return{value:n,label:r,attributes:t,default:s}}))}(r);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function p(e){let{value:n,tabValues:r}=e;return r.some((e=>e.value===n))}function x(e){let{queryString:n=!1,groupId:r}=e;const s=(0,o.W6)(),l=function(e){let{queryString:n=!1,groupId:r}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:n,groupId:r});return[(0,a.aZ)(l),(0,t.useCallback)((e=>{if(!l)return;const n=new URLSearchParams(s.location.search);n.set(l,e),s.replace({...s.location,search:n.toString()})}),[l,s])]}function j(e){const{defaultValue:n,queryString:r=!1,groupId:s}=e,l=h(e),[o,a]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=r.find((e=>e.default))??r[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:l}))),[d,u]=x({queryString:r,groupId:s}),[j,m]=function(e){let{groupId:n}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,l]=(0,c.Dv)(r);return[s,(0,t.useCallback)((e=>{r&&l.set(e)}),[r,l])]}({groupId:s}),g=(()=>{const e=d??j;return p({value:e,tabValues:l})?e:null})();(0,i.A)((()=>{g&&a(g)}),[g]);return{selectedValue:o,selectValue:(0,t.useCallback)((e=>{if(!p({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);a(e),u(e),m(e)}),[u,m,l]),tabValues:l}}var m=r(9136);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var k=r(74848);function b(e){let{className:n,block:r,selectedValue:t,selectValue:o,tabValues:i}=e;const a=[],{blockElementScrollPositionUntilNextRender:d}=(0,l.a_)(),c=e=>{const n=e.currentTarget,r=a.indexOf(n),s=i[r].value;s!==t&&(d(n),o(s))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=a.indexOf(e.currentTarget)+1;n=a[r]??a[0];break}case"ArrowLeft":{const r=a.indexOf(e.currentTarget)-1;n=a[r]??a[a.length-1];break}}n?.focus()};return(0,k.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":r},n),children:i.map((e=>{let{value:n,label:r,attributes:l}=e;return(0,k.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>{a.push(e)},onKeyDown:u,onClick:c,...l,className:(0,s.A)("tabs__item",g.tabItem,l?.className,{"tabs__item--active":t===n}),children:r??n},n)}))})}function v(e){let{lazy:n,children:r,selectedValue:l}=e;const o=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){const e=o.find((e=>e.props.value===l));return e?(0,t.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,k.jsx)("div",{className:"margin-top--md",children:o.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==l})))})}function f(e){const n=j(e);return(0,k.jsxs)("div",{className:(0,s.A)("tabs-container",g.tabList),children:[(0,k.jsx)(b,{...n,...e}),(0,k.jsx)(v,{...n,...e})]})}function y(e){const n=(0,m.A)();return(0,k.jsx)(f,{...e,children:u(e.children)},String(n))}},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var t=r(96540);const s={},l=t.createContext(s);function o(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);