<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/jobs" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Jobs | Daikoku</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://maif.github.io/daikoku/img/daikoku-mini.jpg"><meta data-rh="true" name="twitter:image" content="https://maif.github.io/daikoku/img/daikoku-mini.jpg"><meta data-rh="true" property="og:url" content="https://maif.github.io/daikoku/docs/guides/jobs"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Jobs | Daikoku"><meta data-rh="true" name="description" content="Daikoku includes several background jobs designed to ensure data consistency and the smooth operation of the platform. These tasks run automatically at regular intervals and can be partially customized through configuration. Key jobs include:"><meta data-rh="true" property="og:description" content="Daikoku includes several background jobs designed to ensure data consistency and the smooth operation of the platform. These tasks run automatically at regular intervals and can be partially customized through configuration. Key jobs include:"><link data-rh="true" rel="icon" href="/daikoku/img/daikoku-mini.svg"><link data-rh="true" rel="canonical" href="https://maif.github.io/daikoku/docs/guides/jobs"><link data-rh="true" rel="alternate" href="https://maif.github.io/daikoku/docs/guides/jobs" hreflang="en"><link data-rh="true" rel="alternate" href="https://maif.github.io/daikoku/docs/guides/jobs" hreflang="x-default"><link rel="stylesheet" href="/daikoku/assets/css/styles.98544a2c.css">
<script src="/daikoku/assets/js/runtime~main.2deba45f.js" defer="defer"></script>
<script src="/daikoku/assets/js/main.15cef605.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/daikoku/img/daikoku-mini-dark.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/daikoku/"><div class="navbar__logo"><img src="/daikoku/img/daikoku-mini-dark.svg" alt="Daikoku logo" class="header-logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/daikoku/img/daikoku-mini-dark.svg" alt="Daikoku logo" class="header-logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Daikoku</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/daikoku/docs/getstarted/">Documentation</a><a class="navbar__item navbar__link" href="/daikoku/openapi">OpenAPI</a><a class="navbar__item navbar__link" href="/daikoku/docs/cli">CLI</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/maif/daikoku" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/daikoku/docs/getstarted/">Get started</a><button aria-label="Expand sidebar category &#x27;Get started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/daikoku/docs/usages/">Usages</a><button aria-label="Expand sidebar category &#x27;Usages&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/daikoku/docs/guides/">Guides</a><button aria-label="Collapse sidebar category &#x27;Guides&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/daikoku/docs/guides/archi">Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/daikoku/docs/guides/jobs">Jobs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/daikoku/docs/guides/integrations">Integrations API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/daikoku/docs/guides/apis">Admin API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/daikoku/docs/guides/deploy">Deploy to production</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/daikoku/docs/guides/authentication">Authentication</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/daikoku/docs/cli/">CLI</a><button aria-label="Expand sidebar category &#x27;CLI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/daikoku/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/daikoku/docs/guides/"><span itemprop="name">Guides</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Jobs</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Jobs</h1></header>
<p>Daikoku includes several background jobs designed to ensure data consistency and the smooth operation of the platform. These tasks run automatically at regular intervals and can be partially customized through configuration. Key jobs include:</p>
<ul>
<li>
<p>Synchronization with Otoroshi, to keep API data and usage statistics up to date.</p>
</li>
<li>
<p>Audit trail cleanup, to automatically purge old audit logs and limit storage usage.</p>
</li>
<li>
<p>Notification purge, to remove obsolete or unhandled notifications.</p>
</li>
<li>
<p>Anonymous reporting, which periodically sends anonymized usage statistics to help us improve the tool.</p>
</li>
</ul>
<p>These jobs play a critical role in maintaining Daikoku’s stability, performance, and data hygiene over time.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="notifications-purge-job">Notifications Purge Job<a href="#notifications-purge-job" class="hash-link" aria-label="Direct link to Notifications Purge Job" title="Direct link to Notifications Purge Job">​</a></h2>
<p>The <code>NotificationsPurgeJob</code> is an automated job responsible for periodically deleting obsolete notifications in the Daikoku system. It helps maintain database cleanliness by removing old notifications based on specific criteria.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="job-startup">Job startup<a href="#job-startup" class="hash-link" aria-label="Direct link to Job startup" title="Direct link to Job startup">​</a></h3>
<p>The job starts automatically when the application launches if the <code>daikoku.notifications.purge.cron</code> configuration is enabled. It runs periodically according to the interval configured in <code>daikoku.notifications.purge.interval</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="job-lifecycle">Job lifecycle<a href="#job-lifecycle" class="hash-link" aria-label="Direct link to Job lifecycle" title="Direct link to Job lifecycle">​</a></h3>
<p>The job runs continuously until the application is shut down. It cannot be stopped individually - it only stops when the entire application terminates.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="purge-criteria">Purge criteria<a href="#purge-criteria" class="hash-link" aria-label="Direct link to Purge criteria" title="Direct link to Purge criteria">​</a></h2>
<p>The job deletes notifications based on three main criteria:</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-pending-acceptonly-notifications">1. Pending &quot;AcceptOnly&quot; notifications<a href="#1-pending-acceptonly-notifications" class="hash-link" aria-label="Direct link to 1. Pending &quot;AcceptOnly&quot; notifications" title="Direct link to 1. Pending &quot;AcceptOnly&quot; notifications">​</a></h3>
<ul>
<li><strong>Type</strong>: <code>NotificationType.AcceptOnly</code></li>
<li><strong>Status</strong>: <code>Pending</code></li>
<li><strong>Condition</strong>: Older than <code>daikoku.notifications.purge.max.base.date</code></li>
</ul>
<p>These notifications typically correspond to requests that only require acceptance (like basic information) and have been pending for too long.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-accepted-notifications">2. Accepted notifications<a href="#2-accepted-notifications" class="hash-link" aria-label="Direct link to 2. Accepted notifications" title="Direct link to 2. Accepted notifications">​</a></h3>
<ul>
<li><strong>Status</strong>: <code>Accepted</code></li>
<li><strong>Condition</strong>: Acceptance date older than <code>daikoku.notifications.purge.max.base.date</code></li>
</ul>
<p>Once accepted, the notifications can be deleted after a retention period to free up storage space.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-pending-acceptorreject-notifications">3. Pending &quot;AcceptOrReject&quot; notifications<a href="#3-pending-acceptorreject-notifications" class="hash-link" aria-label="Direct link to 3. Pending &quot;AcceptOrReject&quot; notifications" title="Direct link to 3. Pending &quot;AcceptOrReject&quot; notifications">​</a></h3>
<ul>
<li><strong>Type</strong>: <code>NotificationType.AcceptOrReject</code></li>
<li><strong>Status</strong>: <code>Pending</code></li>
<li><strong>Condition</strong>: Older than <code>daikoku.notifications.purge.max.to.treat.date</code></li>
</ul>
<p>These notifications require an action (accept or reject) and may have a longer retention period.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h2>
<p>The job uses several configuration parameters:</p>
<table><thead><tr><th>Parameter</th><th>Description</th><th>Default Value</th></tr></thead><tbody><tr><td><code>daikoku.notifications.purge.cron</code></td><td>Enables/disables automatic job execution</td><td><code>true</code></td></tr><tr><td><code>daikoku.notifications.purge.interval</code></td><td>Interval between each job execution</td><td><code>1 hours</code></td></tr><tr><td><code>daikoku.notifications.purge.max.date</code></td><td>Retention period for basic notifications</td><td><code>30 days</code></td></tr><tr><td><code>daikoku.notifications.purge.max.to.treat.date</code></td><td>Retention period for notifications requiring treatment</td><td><code>180 days</code></td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/daikoku/docs/guides/archi"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Architecture</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/daikoku/docs/guides/integrations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Integrations API</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#notifications-purge-job" class="table-of-contents__link toc-highlight">Notifications Purge Job</a><ul><li><a href="#job-startup" class="table-of-contents__link toc-highlight">Job startup</a></li><li><a href="#job-lifecycle" class="table-of-contents__link toc-highlight">Job lifecycle</a></li></ul></li><li><a href="#purge-criteria" class="table-of-contents__link toc-highlight">Purge criteria</a><ul><li><a href="#1-pending-acceptonly-notifications" class="table-of-contents__link toc-highlight">1. Pending &quot;AcceptOnly&quot; notifications</a></li><li><a href="#2-accepted-notifications" class="table-of-contents__link toc-highlight">2. Accepted notifications</a></li><li><a href="#3-pending-acceptorreject-notifications" class="table-of-contents__link toc-highlight">3. Pending &quot;AcceptOrReject&quot; notifications</a></li></ul></li><li><a href="#configuration" class="table-of-contents__link toc-highlight">Configuration</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">MAIF</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://maif.github.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OSS by MAIF</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/vUP2eKYu" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/MAIF/daikoku" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/MAIF/daikoku/releases/latest" target="_blank" rel="noopener noreferrer" class="footer__link-item">Download<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
</body>
</html>